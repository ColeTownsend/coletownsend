$(function(){var c=$("a[data-fluidbox]"),b;c.addClass("fluidbox");$("body").append('<div id="fluidbox-overlay" />');var a=function(){$("a[data-fluidbox].fluidbox-opened").trigger("click")},d=function(h){var f=h.find("img"),g=h.find(".fluidbox-ghost");var j=$(window).scrollTop()-f.offset().top+0.5*(f.data("imgHeight")*(f.data("imgScale")-1))+0.5*($(window).height()-f.data("imgHeight")*f.data("imgScale")),e=0.5*(f.data("imgWidth")*(f.data("imgScale")-1))+0.5*($(window).width()-f.data("imgWidth")*f.data("imgScale"))-f.offset().left,i=f.data("imgScale");g.css({transform:"translate("+parseInt(e*10)/10+"px,"+parseInt(j*10)/10+"px) scale("+parseInt(i*1000)/1000+")"})};$("#fluidbox-overlay").click(a);c.imagesLoaded().done(function(){c.wrapInner('<div class="fluidbox-wrap" />').find("img").css({opacity:1}).after('<div class="fluidbox-ghost" />');$(window).resize(function(){b=$(window).width()/$(window).height();c.each(function(){var g=$(this).find("img"),h=$(this).find(".fluidbox-ghost"),f=$(this).find(".fluidbox-wrap"),i=g.data();i.imgWidth=g.width();i.imgHeight=g.height();i.imgRatio=g.width()/g.height();h.css({width:g.width(),height:g.height(),top:g.offset().top-f.offset().top,left:g.offset().left-f.offset().left,});if(b>i.imgRatio){i.imgScale=$(window).height()*0.95/g.height()}else{i.imgScale=$(window).width()*0.95/g.width()}});var e=$("a[data-fluidbox].fluidbox-opened");if(e.length>0){d(e)}}).resize();c.click(function(j){var i=$(this),g=$(this).find("img"),h=$(this).find(".fluidbox-ghost");if($(this).data("fluidbox-state")===0||!$(this).data("fluidbox-state")){$(this).data("fluidbox-state",1).removeClass("fluidbox-closed").addClass("fluidbox-opened");$("#fluidbox-overlay").fadeIn();h.css({"background-image":"url("+g.attr("src")+")",opacity:1});g.css({opacity:0});var f=new Image();f.onload=function(){h.css({"background-image":"url("+i.attr("href")+")"})};f.src=$(this).attr("href");d($(this))}else{$(this).data("fluidbox-state",0).removeClass("fluidbox-opened").addClass("fluidbox-closed");$("#fluidbox-overlay").fadeOut();h.css({transform:"translate(0,0) scale(1)"}).one("webkitTransitionEnd MSTransitionEnd oTransitionEnd otransitionend transitionend",function(){h.css({opacity:0});g.css({opacity:1})})}j.preventDefault()})})});$(window).load(function(){$("header").css({"pointer-events":"auto"})});